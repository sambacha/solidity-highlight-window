<title>Shiki</title>
<link rel="stylesheet" href="style.css">
<pre class="shiki" style="background-color: #2e3440ff"><code><span class="line"><span style="color: #81A1C1">pragma</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">solidity</span><span style="color: #D8DEE9FF"> 0.8.3</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #81A1C1">function</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">_functionCallWithValue</span><span style="color: #D8DEE9FF">(</span><span style="color: #8FBCBB">address</span><span style="color: #D8DEE9FF"> target</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #8FBCBB">bytes</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">memory</span><span style="color: #D8DEE9FF"> data</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #8FBCBB">uint256</span><span style="color: #D8DEE9FF"> weiValue</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #8FBCBB">string</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">memory</span><span style="color: #D8DEE9FF"> errorMessage) </span><span style="color: #81A1C1">private</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">returns</span><span style="color: #D8DEE9FF"> (</span><span style="color: #8FBCBB">bytes</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">memory</span><span style="color: #D8DEE9FF">) {</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">require</span><span style="color: #D8DEE9FF">(</span><span style="color: #88C0D0">isContract</span><span style="color: #D8DEE9FF">(target)</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">&quot;Address: call to non-contract&quot;</span><span style="color: #D8DEE9FF">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #616E88">// solhint-disable-next-line avoid-low-level-calls</span></span>
<span class="line"><span style="color: #D8DEE9FF">    (</span><span style="color: #8FBCBB">bool</span><span style="color: #D8DEE9FF"> success</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #8FBCBB">bytes</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">memory</span><span style="color: #D8DEE9FF"> returndata) </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> target</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9FF">call{ value</span><span style="color: #81A1C1">:</span><span style="color: #D8DEE9FF"> weiValue }(data)</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">if</span><span style="color: #D8DEE9FF"> (success) {</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">return</span><span style="color: #D8DEE9FF"> returndata</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">    } </span><span style="color: #81A1C1">else</span><span style="color: #D8DEE9FF"> {</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #616E88">// Look for revert reason and bubble it up if present</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">if</span><span style="color: #D8DEE9FF"> (returndata</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9FF">length </span><span style="color: #81A1C1">&gt;</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">0</span><span style="color: #D8DEE9FF">) {</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #616E88">// The easiest way to bubble the revert reason is using memory via assembly</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #616E88">// solhint-disable-next-line no-inline-assembly</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #81A1C1">assembly</span><span style="color: #D8DEE9FF"> {</span></span>
<span class="line"><span style="color: #D8DEE9FF">                </span><span style="color: #81A1C1">let</span><span style="color: #D8DEE9FF"> returndata_size </span><span style="color: #81A1C1">:=</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">mload</span><span style="color: #D8DEE9FF">(returndata)</span></span>
<span class="line"><span style="color: #D8DEE9FF">                </span><span style="color: #81A1C1">revert</span><span style="color: #D8DEE9FF">(</span><span style="color: #88C0D0">add</span><span style="color: #D8DEE9FF">(</span><span style="color: #B48EAD">32</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> returndata)</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> returndata_size)</span></span>
<span class="line"><span style="color: #D8DEE9FF">            }</span></span>
<span class="line"><span style="color: #D8DEE9FF">        } </span><span style="color: #81A1C1">else</span><span style="color: #D8DEE9FF"> {</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #81A1C1">revert</span><span style="color: #D8DEE9FF">(errorMessage)</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">        }</span></span>
<span class="line"><span style="color: #D8DEE9FF">    }</span></span>
<span class="line"><span style="color: #D8DEE9FF">}</span></span></code></pre>